<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>How to use SignalR | Johnson&#39;s Blog</title>
  <meta name="keywords" content=" C# , backend , .net ">
  <meta name="description" content="How to use SignalR | Johnson&#39;s Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="Âú® Visual statio‰∏≠ÂàõÂª∫ ÂÆâË£Ö AWS Toolkit for Visual StudioÔºàÂú® VS ËèúÂçïÁöÑ‚ÄúÊâ©Â±ï‚Äù -&gt; ‚ÄúÁÆ°ÁêÜÊâ©Â±ï‚Äù‰∏≠ÊêúÁ¥¢Âç≥ÂèØÔºâ„ÄÇ  ‰Ω†ÈúÄË¶ÅÊâìÂºÄ PowerShell Êàñ CMDÔºåËøêË°å‰∏ãÈù¢ËøôÊù°ÂÆòÊñπÂëΩ‰ª§Ôºö 1dotnet new install Amazon.Lambda.Templates ËøôÊù°ÂëΩ‰ª§‰ºöÊää AWS ÊâÄÊúâÁöÑ C# Ê®°ÊùøÔºàÂåÖÊã¨ Web API, SQ">
<meta property="og:type" content="article">
<meta property="og:title" content="How to use c# in Lambda">
<meta property="og:url" content="https://tjtgzxs.github.io/2026/01/14/CSharp-How%20to%20use%20cSharp%20in%20Lambda/index.html">
<meta property="og:site_name" content="Johnson&#39;s Blog">
<meta property="og:description" content="Âú® Visual statio‰∏≠ÂàõÂª∫ ÂÆâË£Ö AWS Toolkit for Visual StudioÔºàÂú® VS ËèúÂçïÁöÑ‚ÄúÊâ©Â±ï‚Äù -&gt; ‚ÄúÁÆ°ÁêÜÊâ©Â±ï‚Äù‰∏≠ÊêúÁ¥¢Âç≥ÂèØÔºâ„ÄÇ  ‰Ω†ÈúÄË¶ÅÊâìÂºÄ PowerShell Êàñ CMDÔºåËøêË°å‰∏ãÈù¢ËøôÊù°ÂÆòÊñπÂëΩ‰ª§Ôºö 1dotnet new install Amazon.Lambda.Templates ËøôÊù°ÂëΩ‰ª§‰ºöÊää AWS ÊâÄÊúâÁöÑ C# Ê®°ÊùøÔºàÂåÖÊã¨ Web API, SQ">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2026-01-14T13:21:18.000Z">
<meta property="article:modified_time" content="2026-01-14T08:35:33.907Z">
<meta property="article:author" content="Johnson">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="backend">
<meta property="article:tag" content=".net">
<meta property="article:tag" content="database">
<meta property="article:tag" content="Model">
<meta property="article:tag" content="aws">
<meta property="article:tag" content="lambda">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Johnson</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/tjtgzxs"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="facebook"
               href="https://www.facebook.com/faker.tops"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-facebook"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
            <a title="instagram"
               href="https://www.facebook.com/faker.tops"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-instagram"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="reddit"
               href="https://www.reddit.com/user/yelog/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-reddit"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="weibo"
               href="http://weibo.com/u/2307534817"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-weibo"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="jianshu"
               href="https://www.jianshu.com/u/ff56736de7cf"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-jianshu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/people/jaytp/activities"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="oschina"
               href="https://my.oschina.net/yelog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-oschina"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="email"
               href="mailto:jaytp@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=387753733&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="kugou"
               href="https://www.kugou.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-kugou"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="neteasemusic"
               href="https://music.163.com/#/user/home?id=88151013"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-neteasemusic"></use>
                    </svg>
                
            </a>
        
    
</div>



    <a class="more-menus">Êõ¥Â§öËèúÂçï</a>


<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(41)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel=".net">
                        
                        .net
                        <small>(19)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="css">
                        
                        css
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Design_Patterns">
                        
                        Design_Patterns
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="nginx">
                        
                        nginx
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="react">
                        
                        react
                        <small>(7)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
                <a class="dynamic-menu "
                   target="_blank"
                        
                   href="https://github.com/tjtgzxs">github</a>
        
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="41">
<input type="hidden" id="yelog_site_word_count" value="14.7k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">Âè∂ËêΩÈòÅ</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="ÊêúÁ¥¢ Âø´Êç∑ÈîÆ i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="ÂàáÊç¢Âà∞Â§ßÁ∫≤ËßÜÂõæ Âø´Êç∑ÈîÆ w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="ËøîÂõû"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="Â§ßÂ∞èÂÜôÊïèÊÑü"></i>
            <i class="iconfont icon-tag" data-title="Ê†áÁ≠æ"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">Â§ßÁ∫≤</div>
            <i class="iconfont icon-list" data-title="ÂàáÊç¢Âà∞ÊñáÁ´†ÂàóË°®"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>.net</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>accessibility</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>aria</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>aws</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>backend</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>C#</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CORS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>css</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>database</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Eforce</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>frontend</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JWT</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>lambda</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Message Queue</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Model</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nginx</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>page layout</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RabbitMQ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>react</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>react-form</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>react-router</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>react-toast</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>reactQuery</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>server</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>styled-components</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>swagger</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>The Wild Oasis</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>toast</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>visually hidden</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>website</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All .net "
           href="/2026/01/14/CSharp-How%20to%20use%20cSharp%20in%20Lambda/"
           data-tag="C#,backend,.net,database,Model,aws,lambda"
           data-author="" >
            <span class="post-title" title="How to use c# in Lambda">How to use c# in Lambda</span>
            <span class="post-date" title="2026-01-14 21:21:18">2026/01/14</span>
        </a>
        
        
        <a  class="All css "
           href="/2026/01/14/Css-tips/"
           data-tag="css,frontend"
           data-author="" >
            <span class="post-title" title="Css tips">Css tips</span>
            <span class="post-date" title="2026-01-14 16:35:33">2026/01/14</span>
        </a>
        
        
        <a  class="All css "
           href="/2026/01/14/Css-visually%20hide%20text/"
           data-tag="css,frontend,accessibility,aria,visually hidden"
           data-author="" >
            <span class="post-title" title="Css visually hide text">Css visually hide text</span>
            <span class="post-date" title="2026-01-14 16:35:33">2026/01/14</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/09/08/Csharp-RabbitMq/"
           data-tag="C#,backend,.net,RabbitMQ,Message Queue"
           data-author="" >
            <span class="post-title" title="RabbitMQ Use">RabbitMQ Use</span>
            <span class="post-date" title="2025-09-08 21:21:18">2025/09/08</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/09/05/CSharp-Model%20And%20database/"
           data-tag="C#,backend,.net,database,Model"
           data-author="" >
            <span class="post-title" title="Model And DatabaseÔºàEFcore+mysqlÔºâ">Model And DatabaseÔºàEFcore+mysqlÔºâ</span>
            <span class="post-date" title="2025-09-05 21:21:18">2025/09/05</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/28/CSharp-JWT/"
           data-tag="C#,backend,.net,JWT"
           data-author="" >
            <span class="post-title" title="How to use JWT">How to use JWT</span>
            <span class="post-date" title="2025-08-28 19:21:18">2025/08/28</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/28/CSharp-Use%20Filter/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use  filter">How to use  filter</span>
            <span class="post-date" title="2025-08-28 19:21:18">2025/08/28</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-Fluent%20Validator/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use Fluent Validator">How to use Fluent Validator</span>
            <span class="post-date" title="2025-08-27 19:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-Get%20Config%20And%20Secrets/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to get Config And Secrets">How to get Config And Secrets</span>
            <span class="post-date" title="2025-08-27 19:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-Use%20Background%20Service/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to Use Background Service">How to Use Background Service</span>
            <span class="post-date" title="2025-08-27 19:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-Use%20Efcore/"
           data-tag="C#,backend,.net,database,Eforce"
           data-author="" >
            <span class="post-title" title="How to use Efcore (Mysql)">How to use Efcore (Mysql)</span>
            <span class="post-date" title="2025-08-27 19:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-Get%20EnvironmentName/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to get EnvironmentName">How to get EnvironmentName</span>
            <span class="post-date" title="2025-08-27 10:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/27/CSharp-MediatR/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use MediatR">How to use MediatR</span>
            <span class="post-date" title="2025-08-27 10:21:18">2025/08/27</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-Cache/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use Cache">How to use Cache</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-Create%20Async%20function/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to create async function">How to create async function</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-DDD%20Structure/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to design DDD Pattern">How to design DDD Pattern</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-SignalR/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use SignalR">How to use SignalR</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-Solve%20Cors%20in%20.NET%20core%20webAPI/"
           data-tag="C#,backend,.net,CORS"
           data-author="" >
            <span class="post-title" title="How to solve cors in .Net core">How to solve cors in .Net core</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-Use%20DI%20inject%20services%20In%20Controller/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use DI inject services In Controller">How to use DI inject services In Controller</span>
            <span class="post-date" title="2025-08-26 21:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-Add%20swagger%20and%20swagger%20UI%20in%20.net%20core%20WebApi/"
           data-tag="C#,swagger,backend,.net"
           data-author="" >
            <span class="post-title" title="How to add swagger and swagger UI in .net core WebApi">How to add swagger and swagger UI in .net core WebApi</span>
            <span class="post-date" title="2025-08-26 14:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All .net "
           href="/2025/08/26/CSharp-use%20Identity/"
           data-tag="C#,backend,.net"
           data-author="" >
            <span class="post-title" title="How to use Identity">How to use Identity</span>
            <span class="post-date" title="2025-08-26 14:21:18">2025/08/26</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/19/React-07-React-Hook-Form/"
           data-tag="frontend,react,website,The Wild Oasis,react-form"
           data-author="" >
            <span class="post-title" title="react-05-reactQuery">react-05-reactQuery</span>
            <span class="post-date" title="2024-11-19 17:44:03">2024/11/19</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/15/React-06-hot-toast/"
           data-tag="frontend,react,website,The Wild Oasis,react-toast"
           data-author="" >
            <span class="post-title" title="react-05-reactQuery">react-05-reactQuery</span>
            <span class="post-date" title="2024-11-15 17:44:03">2024/11/15</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/06/react-04-App-layout/"
           data-tag="frontend,react,website,The Wild Oasis,page layout"
           data-author="" >
            <span class="post-title" title="react-03-react-router">react-03-react-router</span>
            <span class="post-date" title="2024-11-06 17:44:03">2024/11/06</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/06/react-05-reactQuery/"
           data-tag="frontend,react,website,The Wild Oasis,reactQuery,toast"
           data-author="" >
            <span class="post-title" title="react-05-reactQuery">react-05-reactQuery</span>
            <span class="post-date" title="2024-11-06 17:44:03">2024/11/06</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/06/react-03-react-router/"
           data-tag="frontend,react,website,The Wild Oasis,react-router"
           data-author="" >
            <span class="post-title" title="react-03-react-router">react-03-react-router</span>
            <span class="post-date" title="2024-11-06 16:32:03">2024/11/06</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/06/react-02-styled-components/"
           data-tag="css,frontend,react,website,The Wild Oasis,styled-components"
           data-author="" >
            <span class="post-title" title="react-02-styled-component">react-02-styled-component</span>
            <span class="post-date" title="2024-11-06 13:32:03">2024/11/06</span>
        </a>
        
        
        <a  class="All react "
           href="/2024/11/06/react-01-application_plan/"
           data-tag="frontend,react,website,The Wild Oasis"
           data-author="" >
            <span class="post-title" title="react-01-application_plan">react-01-application_plan</span>
            <span class="post-date" title="2024-11-06 11:25:23">2024/11/06</span>
        </a>
        
        
        <a  class="All Design_Patterns "
           href="/2023/09/05/Design_Patterns%20_Adapter_Pattern/"
           data-tag="backend,php"
           data-author="" >
            <span class="post-title" title="Design_Patterns _Adapter_Pattern">Design_Patterns _Adapter_Pattern</span>
            <span class="post-date" title="2023-09-05 12:01:10">2023/09/05</span>
        </a>
        
        
        <a  class="All Design_Patterns "
           href="/2023/09/01/Design_Patterns%20_Decorator_Pattern/"
           data-tag="backend,php"
           data-author="" >
            <span class="post-title" title="Design_Patterns _Decorator_Pattern">Design_Patterns _Decorator_Pattern</span>
            <span class="post-date" title="2023-09-01 12:01:10">2023/09/01</span>
        </a>
        
        
        <a  class="All Design_Patterns "
           href="/2023/08/31/Design_Patterns_Abstract%20_Factory_Pattern%20/"
           data-tag="backend,php"
           data-author="" >
            <span class="post-title" title="Design_Patterns Abstract Factory Pattern">Design_Patterns Abstract Factory Pattern</span>
            <span class="post-date" title="2023-08-31 12:01:10">2023/08/31</span>
        </a>
        
        
        <a  class="All nginx "
           href="/2023/08/30/nginx03-events/"
           data-tag="backend,website,nginx,server"
           data-author="" >
            <span class="post-title" title="nginx03-events">nginx03-events</span>
            <span class="post-date" title="2023-08-30 11:14:31">2023/08/30</span>
        </a>
        
        
        <a  class="All Design_Patterns "
           href="/2023/08/29/Design_Patterns_Factory_Pattern/"
           data-tag="backend,php"
           data-author="" >
            <span class="post-title" title="Design_Patterns Factory Pattern">Design_Patterns Factory Pattern</span>
            <span class="post-date" title="2023-08-29 12:32:10">2023/08/29</span>
        </a>
        
        
        <a  class="All Design_Patterns "
           href="/2023/08/29/Design_Patterns_Simple_Factory_Pattern/"
           data-tag="backend,php"
           data-author="" >
            <span class="post-title" title="Design_Patterns Simple Factory Pattern">Design_Patterns Simple Factory Pattern</span>
            <span class="post-date" title="2023-08-29 12:01:10">2023/08/29</span>
        </a>
        
        
        <a  class="All "
           href="/2023/08/29/git/"
           data-tag="git"
           data-author="" >
            <span class="post-title" title="Git">Git</span>
            <span class="post-date" title="2023-08-29 12:01:10">2023/08/29</span>
        </a>
        
        
        <a  class="All css "
           href="/2023/08/28/Css-Flex/"
           data-tag="css,frontend"
           data-author="" >
            <span class="post-title" title="Css-flex">Css-flex</span>
            <span class="post-date" title="2023-08-28 14:21:18">2023/08/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/08/28/docker-01/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="docker-01">docker-01</span>
            <span class="post-date" title="2023-08-28 14:21:18">2023/08/28</span>
        </a>
        
        
        <a  class="All nginx "
           href="/2023/08/28/nginx02-core/"
           data-tag="backend,website,nginx,server"
           data-author="" >
            <span class="post-title" title="nginx02-core">nginx02-core</span>
            <span class="post-date" title="2023-08-28 11:12:23">2023/08/28</span>
        </a>
        
        
        <a  class="All nginx "
           href="/2023/08/28/nginx05-http-server%20/"
           data-tag="backend,website,nginx,server"
           data-author="" >
            <span class="post-title" title="nginx05-http-server">nginx05-http-server</span>
            <span class="post-date" title="2023-08-28 11:12:23">2023/08/28</span>
        </a>
        
        
        <a  class="All nginx "
           href="/2023/08/27/nginx01-Command%20Params/"
           data-tag="backend,website,nginx,server"
           data-author="" >
            <span class="post-title" title="nginx01-cmd params">nginx01-cmd params</span>
            <span class="post-date" title="2023-08-27 16:14:31">2023/08/27</span>
        </a>
        
        
        <a  class="All nginx "
           href="/2023/08/27/nginx04-http/"
           data-tag="backend,website,nginx,server"
           data-author="" >
            <span class="post-title" title="nginx01-http">nginx01-http</span>
            <span class="post-date" title="2023-08-27 16:14:31">2023/08/27</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="ÂàáÊç¢ÂÖ®Â±è Âø´Êç∑ÈîÆ s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-CSharp-SignalR" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">How to use SignalR</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel=".net">.net</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">C#</a>
            
            <a class="color3">backend</a>
            
            <a class="color5">.net</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2026-01-14 16:35:33'>2025-08-26 21:21</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:2.5k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views üëÄ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Create-a-class-to-extend-Hub-base-class"><span class="toc-text">Create a class to extend Hub base class</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#In-Programs-cs-Add-hub-service-and-allow-cors"><span class="toc-text">In Programs.cs (Add hub service and allow cors)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Must-Before-app-MapControllers-use-app-MapHub-%E2%80%9C-Hub-ChatRoomHub%E2%80%9D"><span class="toc-text">Must Before app.MapControllers(); use app.MapHub(‚Äú&#x2F;Hub&#x2F;ChatRoomHub‚Äù);</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Front-Side"><span class="toc-text">Front Side</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#page-src"><span class="toc-text">page.src</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Add-Distribute-SignalR-server"><span class="toc-text">Add Distribute SignalR server</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Add-Microsoft-AspNetCore-SignalR-StackExchangeRedis-Package"><span class="toc-text">Add Microsoft.AspNetCore.SignalR.StackExchangeRedis Package</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IN-program-cs"><span class="toc-text">IN program.cs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#start-Jwt-and-send-message-to-specific-user"><span class="toc-text">start Jwt and send message to specific user</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#In-program-cs"><span class="toc-text">In program.cs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#In-HubClass"><span class="toc-text">In HubClass</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Font-side"><span class="toc-text">Font side</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Send-private-Massege"><span class="toc-text">Send private Massege</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#IN-hub"><span class="toc-text">IN hub</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Font-Side"><span class="toc-text">Font Side</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#send-Massege-from-Controller"><span class="toc-text">send Massege from Controller</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Create-a-class-to-extend-Hub-base-class"><a href="#Create-a-class-to-extend-Hub-base-class" class="headerlink" title="Create a class to extend Hub base class"></a>Create a class to extend Hub base class</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.SignalR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">SignalR</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HubClass</span>:<span class="title">Hub</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="function"><span class="keyword">public</span>  Task <span class="title">SendPublicMsg</span>(<span class="params"><span class="built_in">string</span> user,<span class="built_in">string</span> msg</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="built_in">string</span> connId = <span class="keyword">this</span>.Context.ConnectionId;</span><br><span class="line">       <span class="built_in">string</span> msgSend=<span class="string">$&quot;<span class="subst">&#123;connId&#125;</span>-<span class="subst">&#123;DateTime.Now&#125;</span>-<span class="subst">&#123;msg&#125;</span>:from<span class="subst">&#123;user&#125;</span>&quot;</span>;</span><br><span class="line">       <span class="keyword">return</span> Clients.All.SendCoreAsync(<span class="string">&quot;PublicMsgRecieved&quot;</span>, <span class="keyword">new</span> <span class="built_in">object</span>[] &#123; msgSend &#125;);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="In-Programs-cs-Add-hub-service-and-allow-cors"><a href="#In-Programs-cs-Add-hub-service-and-allow-cors" class="headerlink" title="In Programs.cs (Add hub service and allow cors)"></a>In Programs.cs (Add hub service and allow <font color="red">cors</font>)</h1><h1 id="Must-Before-app-MapControllers-use-app-MapHub-‚Äú-Hub-ChatRoomHub‚Äù"><a href="#Must-Before-app-MapControllers-use-app-MapHub-‚Äú-Hub-ChatRoomHub‚Äù" class="headerlink" title="Must Before app.MapControllers(); use app.MapHub(‚Äú&#x2F;Hub&#x2F;ChatRoomHub‚Äù);"></a>Must <font color="red">Before</font> app.MapControllers(); use app.MapHub<HubClass>(‚Äú&#x2F;Hub&#x2F;ChatRoomHub‚Äù);</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">   builder.Services.AddSignalR();</span><br><span class="line">   builder.Services.AddCors(options =&gt;</span><br><span class="line">   &#123;</span><br><span class="line">       options.AddPolicy(<span class="string">&quot;AllowReactApp&quot;</span>,</span><br><span class="line">           policy =&gt;</span><br><span class="line">           &#123;</span><br><span class="line">               policy.WithOrigins(<span class="string">&quot;http://localhost:5173&quot;</span>) <span class="comment">// React ÂêØÂä®ÁöÑÂú∞ÂùÄ</span></span><br><span class="line">                   .AllowAnyHeader()</span><br><span class="line">                   .AllowAnyMethod();</span><br><span class="line">           &#125;);</span><br><span class="line">   &#125;);</span><br><span class="line">... other services</span><br><span class="line"></span><br><span class="line">... other use</span><br><span class="line">    app.UseCors(<span class="string">&quot;AllowReactApp&quot;</span>);</span><br><span class="line">     app.MapHub&lt;HubClass&gt;(<span class="string">&quot;/Hub/ChatRoomHub&quot;</span>);</span><br><span class="line"></span><br><span class="line">     app.MapControllers();<span class="comment">//Must before this </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Front-Side"><a href="#Front-Side" class="headerlink" title="Front Side"></a>Front Side</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @microsoft/signalr</span><br></pre></td></tr></table></figure>
<h1 id="page-src"><a href="#page-src" class="headerlink" title="page.src"></a>page.src</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&quot;@microsoft/signalr&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [connection, setConnection] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">const</span> [connected, setConnected] = <span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">// ËøûÊé•Áä∂ÊÄÅ</span></span><br><span class="line">    <span class="keyword">const</span> [messages, setMessages] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="keyword">const</span> [input, setInput] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Intital SignalR Connection</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> options=&#123;<span class="attr">skipNegotiation</span>: <span class="literal">true</span>,<span class="attr">transport</span>:signalR.<span class="property">HttpTransportType</span>.<span class="property">WebSockets</span>&#125;;<span class="comment">//Forbid Negotiation</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> newConnection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span><br><span class="line">            .<span class="title function_">withUrl</span>(<span class="string">&quot;https://localhost:7046/Hub/ChatRoomHub&quot;</span>,options)<span class="comment">//Forbid Negotiation</span></span><br><span class="line">            .<span class="title function_">withAutomaticReconnect</span>()</span><br><span class="line">            .<span class="title function_">build</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setConnection</span>(newConnection);</span><br><span class="line">    &#125;, []);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂêØÂä®ËøûÊé•Âπ∂Ê≥®ÂÜå‰∫ã‰ª∂</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (connection) &#123;</span><br><span class="line">            connection.<span class="title function_">on</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, msg]);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            connection.<span class="title function_">start</span>()</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;SignalR Connected&quot;</span>);</span><br><span class="line">                    <span class="title function_">setConnected</span>(<span class="literal">true</span>); <span class="comment">// ËøûÊé•ÊàêÂäü</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Connection failed:&quot;</span>, err));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Ê∏ÖÁêÜ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                connection.<span class="title function_">off</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [connection]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂèëÈÄÅÊ∂àÊÅØ</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!connected) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Connection not ready yet&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (input.<span class="title function_">trim</span>() === <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMsg&quot;</span>, <span class="string">&quot;ReactUser&quot;</span>, input);</span><br><span class="line">            <span class="title function_">setInput</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Send failed:&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">maxWidth:</span> &quot;<span class="attr">600px</span>&quot;, <span class="attr">margin:</span> &quot;<span class="attr">20px</span> <span class="attr">auto</span>&quot;, <span class="attr">fontFamily:</span> &quot;<span class="attr">Arial</span>, <span class="attr">sans-serif</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>React + SignalR Chat<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">border:</span> &quot;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&quot;, <span class="attr">padding:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">minHeight:</span> &quot;<span class="attr">200px</span>&quot;, <span class="attr">marginBottom:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">overflowY:</span> &quot;<span class="attr">auto</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;messages.map((msg, i) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span>&gt;</span>&#123;msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">value</span>=<span class="string">&#123;input&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setInput(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">                placeholder=&quot;Type message...&quot;</span></span><br><span class="line"><span class="language-xml">                style=&#123;&#123; padding: &quot;5px&quot;, width: &quot;70%&quot;, marginRight: &quot;10px&quot; &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">disabled</span>=<span class="string">&#123;!connected&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> &quot;<span class="attr">5px</span> <span class="attr">15px</span>&quot; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">                Send</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;!connected &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot; &#125;&#125;&gt;</span>Connecting...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Add-Distribute-SignalR-server"><a href="#Add-Distribute-SignalR-server" class="headerlink" title="Add Distribute SignalR server"></a>Add Distribute SignalR server</h1><h1 id="Add-Microsoft-AspNetCore-SignalR-StackExchangeRedis-Package"><a href="#Add-Microsoft-AspNetCore-SignalR-StackExchangeRedis-Package" class="headerlink" title="Add Microsoft.AspNetCore.SignalR.StackExchangeRedis Package"></a>Add <font color="red">Microsoft.AspNetCore.SignalR.StackExchangeRedis</font> Package</h1><h1 id="IN-program-cs"><a href="#IN-program-cs" class="headerlink" title="IN program.cs"></a>IN program.cs</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//builder.Services.AddSignalR();</span></span><br><span class="line">builder.Services.AddSignalR().AddStackExchangeRedis(<span class="string">&quot;127.0.0.1:63791&quot;</span>,opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    opt.Configuration.ChannelPrefix = <span class="string">&quot;SignalR_SignalR_&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="start-Jwt-and-send-message-to-specific-user"><a href="#start-Jwt-and-send-message-to-specific-user" class="headerlink" title="start Jwt and send message to specific user"></a>start Jwt and send message to specific user</h1><h1 id="In-program-cs"><a href="#In-program-cs" class="headerlink" title="In program.cs"></a>In program.cs</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in jwt Builder</span></span><br><span class="line"> builder.Services.Configure&lt;JWTSettings&gt;(builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br><span class="line"> builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme).AddJwtBearer(x =&gt;</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">var</span> jwtOpt = builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTSettings&gt;();</span><br><span class="line">         <span class="built_in">byte</span>[] keyBytes = Encoding.UTF8.GetBytes(jwtOpt.SecKey);</span><br><span class="line">         <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(keyBytes);</span><br><span class="line">         x.TokenValidationParameters = <span class="keyword">new</span>()</span><br><span class="line">         &#123;</span><br><span class="line">             ValidateIssuer = <span class="literal">false</span>,</span><br><span class="line">             ValidateAudience = <span class="literal">false</span>,</span><br><span class="line">             ValidateLifetime = <span class="literal">true</span>,</span><br><span class="line">             ValidateIssuerSigningKey = <span class="literal">true</span>,</span><br><span class="line">             IssuerSigningKey = secKey</span><br><span class="line">         &#125;;</span><br><span class="line">         <span class="comment">/** start SignalR setting **/</span></span><br><span class="line">         x.Events = <span class="keyword">new</span> JwtBearerEvents</span><br><span class="line">         &#123;</span><br><span class="line">             OnMessageReceived = context =&gt;</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="keyword">var</span> accessToken = context.Request.Query[<span class="string">&quot;access_token&quot;</span>];</span><br><span class="line">                 <span class="keyword">var</span> path = context.Request.Path;</span><br><span class="line">                 <span class="keyword">if</span> (path.StartsWithSegments(<span class="string">&quot;/Hub/ChatRoomHub&quot;</span>) &amp;&amp; !String.IsNullOrEmpty(accessToken))</span><br><span class="line">                 &#123;</span><br><span class="line">                     context.Token = accessToken;</span><br><span class="line">                 &#125;</span><br><span class="line"></span><br><span class="line">                 <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"> );</span><br></pre></td></tr></table></figure>

<h1 id="In-HubClass"><a href="#In-HubClass" class="headerlink" title="In HubClass"></a>In HubClass</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Security.Claims;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Authorization;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Components.Authorization;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.SignalR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">SignalR</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Authorize</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HubClass</span>:<span class="title">Hub</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  Task <span class="title">SendPublicMsg</span>(<span class="params"><span class="built_in">string</span> user,<span class="built_in">string</span> msg</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> claim=<span class="keyword">this</span>.Context.User.FindFirst(ClaimTypes.Name);<span class="comment">//Get Name</span></span><br><span class="line">            <span class="built_in">string</span> connId = <span class="keyword">this</span>.Context.ConnectionId; </span><br><span class="line">            <span class="built_in">string</span> msgSend=<span class="string">$&quot;<span class="subst">&#123;connId&#125;</span>-<span class="subst">&#123;DateTime.Now&#125;</span>-<span class="subst">&#123;msg&#125;</span>:from<span class="subst">&#123;user&#125;</span>&amp;Name:<span class="subst">&#123;claim.Value&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> Clients.All.SendCoreAsync(<span class="string">&quot;PublicMsgRecieved&quot;</span>, <span class="keyword">new</span> <span class="built_in">object</span>[] &#123; msgSend &#125;);</span><br><span class="line">           </span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Font-side"><a href="#Font-side" class="headerlink" title="Font side"></a>Font side</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&quot;@microsoft/signalr&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [connection, setConnection] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">const</span> [connected, setConnected] = <span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">// ËøûÊé•Áä∂ÊÄÅ</span></span><br><span class="line">    <span class="keyword">const</span> [messages, setMessages] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="keyword">const</span> [input, setInput] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [userName, setUserName] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [loginMessage, setLoginMessage] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [userToken, setUserToken] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂàùÂßãÂåñ SignalR ËøûÊé•</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!userToken) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">const</span> options=&#123;<span class="attr">skipNegotiation</span>: <span class="literal">true</span>,<span class="attr">transport</span>:signalR.<span class="property">HttpTransportType</span>.<span class="property">WebSockets</span>&#125;;</span><br><span class="line"></span><br><span class="line">        options.<span class="property">accessTokenFactory</span> = <span class="function">()=&gt;</span>userToken;<span class="comment">//add JWTToken</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(options);</span><br><span class="line">        <span class="keyword">const</span> newConnection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span><br><span class="line">            .<span class="title function_">withUrl</span>(<span class="string">&quot;https://localhost:7046/Hub/ChatRoomHub&quot;</span>,options)</span><br><span class="line">            .<span class="title function_">withAutomaticReconnect</span>()</span><br><span class="line">            .<span class="title function_">build</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setConnection</span>(newConnection);</span><br><span class="line">    &#125;, [userToken]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂêØÂä®ËøûÊé•Âπ∂Ê≥®ÂÜå‰∫ã‰ª∂</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (connection) &#123;</span><br><span class="line">            connection.<span class="title function_">on</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, msg]);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            connection.<span class="title function_">start</span>()</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;SignalR Connected&quot;</span>);</span><br><span class="line">                    <span class="title function_">setConnected</span>(<span class="literal">true</span>); <span class="comment">// ËøûÊé•ÊàêÂäü</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Connection failed:&quot;</span>, err));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Ê∏ÖÁêÜ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                connection.<span class="title function_">off</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [connection]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂèëÈÄÅÊ∂àÊÅØ</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!connected) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Connection not ready yet&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (input.<span class="title function_">trim</span>() === <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMsg&quot;</span>, <span class="string">&quot;ReactUser&quot;</span>, input);</span><br><span class="line">            <span class="title function_">setInput</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Send failed:&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">loginHandler</span> = <span class="keyword">async</span> (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="keyword">if</span>(userName==<span class="literal">null</span>||password==<span class="literal">null</span>||password==<span class="literal">undefined</span>||password.<span class="property">length</span>==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="title function_">setLoginMessage</span>(<span class="string">&quot;Please enter first name&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">            formData.<span class="title function_">append</span>(<span class="string">&quot;UserName&quot;</span>, userName);</span><br><span class="line">            formData.<span class="title function_">append</span>(<span class="string">&quot;Password&quot;</span>, password);</span><br><span class="line">           <span class="keyword">const</span> resp= <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://localhost:7046/api/Test2/Login&quot;</span>, &#123;</span><br><span class="line">               <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">               <span class="attr">body</span>: formData</span><br><span class="line">           &#125;);</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Login Response:&quot;</span>, resp);</span><br><span class="line">           <span class="keyword">if</span> (resp.<span class="property">status</span> === <span class="number">200</span>)&#123;</span><br><span class="line">             <span class="comment">// ‚¨ÖÔ∏è Ëß£ÊûêÂìçÂ∫î‰Ωì</span></span><br><span class="line">               <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Login Response:&quot;</span>, resp);</span><br><span class="line">               <span class="title function_">setUserToken</span>(<span class="keyword">await</span> resp.<span class="title function_">text</span>());<span class="comment">// add JWT To Token</span></span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">maxWidth:</span> &quot;<span class="attr">600px</span>&quot;, <span class="attr">margin:</span> &quot;<span class="attr">20px</span> <span class="attr">auto</span>&quot;, <span class="attr">fontFamily:</span> &quot;<span class="attr">Arial</span>, <span class="attr">sans-serif</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>React + SignalR Chat<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">border:</span> &quot;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&quot;, <span class="attr">padding:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">minHeight:</span> &quot;<span class="attr">200px</span>&quot;, <span class="attr">marginBottom:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">overflowY:</span> &quot;<span class="attr">auto</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;messages.map((msg, i) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span>&gt;</span>&#123;msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">value</span>=<span class="string">&#123;input&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setInput(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">                placeholder=&quot;Type message...&quot;</span></span><br><span class="line"><span class="language-xml">                style=&#123;&#123; padding: &quot;5px&quot;, width: &quot;70%&quot;, marginRight: &quot;10px&quot; &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">disabled</span>=<span class="string">&#123;!connected&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> &quot;<span class="attr">5px</span> <span class="attr">15px</span>&quot; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">                Send</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;!connected &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot; &#125;&#125;&gt;</span>Connecting...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">mt-4</span>`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;UserName&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setUserName(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;Password&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setPassword(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;loginHandler&#125;</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">bg-blue-950</span>`&#125;&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;loginMessage&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Send-private-Massege"><a href="#Send-private-Massege" class="headerlink" title="Send private Massege"></a>Send private Massege</h1><h2 id="IN-hub"><a href="#IN-hub" class="headerlink" title="IN hub"></a>IN hub</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Security.Claims;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Authorization;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Components.Authorization;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Identity;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.SignalR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">SignalR</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Authorize</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HubClass</span>:<span class="title">Hub</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> UserManager&lt;MyUser&gt; _user;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HubClass</span>(<span class="params">UserManager&lt;MyUser&gt; user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _user = user;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">SendPrivateMsg</span>(<span class="params">String destName, String msg</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            MyUser? user = <span class="keyword">await</span> _user.FindByNameAsync(destName);</span><br><span class="line">            <span class="built_in">long</span> uid = user.Id;</span><br><span class="line">            <span class="keyword">var</span> fromUserName = <span class="keyword">this</span>.Context.UserIdentifier;</span><br><span class="line">            <span class="keyword">await</span> Clients.User(uid.ToString()).SendAsync(<span class="string">&quot;PrivateMsgRecived&quot;</span>, fromUserName,DateTime.Now.ToShortTimeString(), msg);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;OK&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Font-Side"><a href="#Font-Side" class="headerlink" title="Font Side"></a>Font Side</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&quot;@microsoft/signalr&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [connection, setConnection] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">const</span> [connected, setConnected] = <span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">// ËøûÊé•Áä∂ÊÄÅ</span></span><br><span class="line">    <span class="keyword">const</span> [messages, setMessages] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="keyword">const</span> [input, setInput] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [privateInput, setPrivateInput] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [destinationUsername, setDestinationUsername] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [userName, setUserName] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [loginMessage, setLoginMessage] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> [userToken, setUserToken] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂàùÂßãÂåñ SignalR ËøûÊé•</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!userToken) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">const</span> options=&#123;<span class="attr">skipNegotiation</span>: <span class="literal">true</span>,<span class="attr">transport</span>:signalR.<span class="property">HttpTransportType</span>.<span class="property">WebSockets</span>&#125;;</span><br><span class="line"></span><br><span class="line">        options.<span class="property">accessTokenFactory</span> = <span class="function">()=&gt;</span>userToken;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(options);</span><br><span class="line">        <span class="keyword">const</span> newConnection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span><br><span class="line">            .<span class="title function_">withUrl</span>(<span class="string">&quot;https://localhost:7046/Hub/ChatRoomHub&quot;</span>,options)</span><br><span class="line">            .<span class="title function_">withAutomaticReconnect</span>()</span><br><span class="line">            .<span class="title function_">build</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setConnection</span>(newConnection);</span><br><span class="line">    &#125;, [userToken]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂêØÂä®ËøûÊé•Âπ∂Ê≥®ÂÜå‰∫ã‰ª∂</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (connection) &#123;</span><br><span class="line">            connection.<span class="title function_">on</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, msg]);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//add private reciever</span></span><br><span class="line">            connection.<span class="title function_">on</span>(<span class="string">&quot;PrivateMsgRecived&quot;</span>, <span class="function">(<span class="params">fromName,time,msg</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, <span class="string">`User <span class="subst">$&#123;fromName&#125;</span> at <span class="subst">$&#123;time&#125;</span> send <span class="subst">$&#123;msg&#125;</span>`</span>]);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            connection.<span class="title function_">start</span>()</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;SignalR Connected&quot;</span>);</span><br><span class="line">                    <span class="title function_">setConnected</span>(<span class="literal">true</span>); <span class="comment">// ËøûÊé•ÊàêÂäü</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Connection failed:&quot;</span>, err));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Ê∏ÖÁêÜ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                connection.<span class="title function_">off</span>(<span class="string">&quot;PublicMsgRecieved&quot;</span>);</span><br><span class="line">                connection.<span class="title function_">off</span>(<span class="string">&quot;PrivateMsgRecived&quot;</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [connection]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂèëÈÄÅÊ∂àÊÅØ</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!connected) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Connection not ready yet&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (input.<span class="title function_">trim</span>() === <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMsg&quot;</span>, <span class="string">&quot;ReactUser&quot;</span>, input);</span><br><span class="line">            <span class="title function_">setInput</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Send failed:&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">sendPrivateMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!connected) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Connection not ready yet&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (privateInput.<span class="title function_">trim</span>() === <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPrivateMsg&quot;</span>,  destinationUsername,  privateInput);</span><br><span class="line">            <span class="title function_">setPrivateInput</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Send failed:&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">loginHandler</span> = <span class="keyword">async</span> (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="keyword">if</span>(userName==<span class="literal">null</span>||password==<span class="literal">null</span>||password==<span class="literal">undefined</span>||password.<span class="property">length</span>==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="title function_">setLoginMessage</span>(<span class="string">&quot;Please enter first name&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">            formData.<span class="title function_">append</span>(<span class="string">&quot;UserName&quot;</span>, userName);</span><br><span class="line">            formData.<span class="title function_">append</span>(<span class="string">&quot;Password&quot;</span>, password);</span><br><span class="line">           <span class="keyword">const</span> resp= <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://localhost:7046/api/Test2/Login&quot;</span>, &#123;</span><br><span class="line">               <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">               <span class="attr">body</span>: formData</span><br><span class="line">           &#125;);</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Login Response:&quot;</span>, resp);</span><br><span class="line">           <span class="keyword">if</span> (resp.<span class="property">status</span> === <span class="number">200</span>)&#123;</span><br><span class="line">             <span class="comment">// ‚¨ÖÔ∏è Ëß£ÊûêÂìçÂ∫î‰Ωì</span></span><br><span class="line">               <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Login Response:&quot;</span>, resp);</span><br><span class="line">               <span class="title function_">setUserToken</span>(<span class="keyword">await</span> resp.<span class="title function_">text</span>());</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">maxWidth:</span> &quot;<span class="attr">600px</span>&quot;, <span class="attr">margin:</span> &quot;<span class="attr">20px</span> <span class="attr">auto</span>&quot;, <span class="attr">fontFamily:</span> &quot;<span class="attr">Arial</span>, <span class="attr">sans-serif</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>React + SignalR Chat<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">border:</span> &quot;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&quot;, <span class="attr">padding:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">minHeight:</span> &quot;<span class="attr">200px</span>&quot;, <span class="attr">marginBottom:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">overflowY:</span> &quot;<span class="attr">auto</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;messages.map((msg, i) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span>&gt;</span>&#123;msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">value</span>=<span class="string">&#123;input&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setInput(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">                placeholder=&quot;Type message...&quot;</span></span><br><span class="line"><span class="language-xml">                style=&#123;&#123; padding: &quot;5px&quot;, width: &quot;70%&quot;, marginRight: &quot;10px&quot; &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">disabled</span>=<span class="string">&#123;!connected&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> &quot;<span class="attr">5px</span> <span class="attr">15px</span>&quot; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">                Send</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;!connected &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> &quot;<span class="attr">10px</span>&quot;, <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot; &#125;&#125;&gt;</span>Connecting...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">mt-4</span>`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;UserName&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setUserName(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;Password&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setPassword(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;loginHandler&#125;</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">bg-blue-950</span>`&#125;&gt;</span>Login<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;loginMessage&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;userToken &amp;&amp;</span></span><br><span class="line"><span class="language-xml">                ( <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">mt-4</span>`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;destinationUsername&#125;</span> <span class="attr">placeholder</span>=<span class="string">&#123;</span>&quot;<span class="attr">Destination</span> <span class="attr">User</span> <span class="attr">name</span>&quot;&#125; <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setDestinationUsername(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;privateInput&#125;</span> <span class="attr">placeholder</span>=<span class="string">&#123;</span>&quot;<span class="attr">Private</span> <span class="attr">Massage</span>&quot;&#125; <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setPrivateInput(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;sendPrivateMessage&#125;</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">bg-blue-950</span>`&#125;&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="send-Massege-from-Controller"><a href="#send-Massege-from-Controller" class="headerlink" title="send Massege from Controller"></a>send Massege from Controller</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Test2</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;MyUser&gt; _userManager;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> RoleManager&lt;MyRole&gt; _roleManager;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IOptionsSnapshot&lt;JWTSettings&gt; _settings;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IHubContext&lt;HubClass&gt; _hubContext;<span class="comment">// Inject IhubContext</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Test2</span>(<span class="params">UserManager&lt;MyUser&gt; userManager, RoleManager&lt;MyRole&gt; roleManager, IOptionsSnapshot&lt;JWTSettings&gt; settings, IHubContext&lt;HubClass&gt; hubContext</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _userManager = userManager;</span><br><span class="line">        _roleManager = roleManager;</span><br><span class="line">        _settings = settings;</span><br><span class="line">        _hubContext = hubContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>&gt;&gt; CreateUSer([FromForm] <span class="built_in">string</span> userName, [FromForm] <span class="built_in">string</span> password)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">await</span> _roleManager.RoleExistsAsync(<span class="string">&quot;admin&quot;</span>) == <span class="literal">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            MyRole role = <span class="keyword">new</span> MyRole() &#123; Name = <span class="string">&quot;admin&quot;</span> &#125;;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> _roleManager.CreateAsync(role);</span><br><span class="line">            <span class="keyword">if</span> (result.Succeeded == <span class="literal">false</span>) <span class="keyword">return</span> BadRequest(<span class="string">&quot;Create Async error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        MyUser user1 = <span class="keyword">await</span> _userManager.FindByNameAsync(userName);</span><br><span class="line">        <span class="keyword">if</span> (user1 == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            user1 = <span class="keyword">new</span> MyUser() &#123; UserName = userName &#125;;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> _userManager.CreateAsync(user1, password);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (result.Succeeded == <span class="literal">false</span>) <span class="keyword">return</span> BadRequest(<span class="string">&quot;Create User Error&quot;</span>+result.Errors);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">await</span> _userManager.IsInRoleAsync(user1, <span class="string">&quot;admin&quot;</span>) == <span class="literal">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> _userManager.AddToRoleAsync(user1, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (result.Succeeded == <span class="literal">false</span>) <span class="keyword">return</span> BadRequest(<span class="string">&quot;Add role User Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> _hubContext.Clients.All.SendAsync(<span class="string">&quot;CreateUser&quot;</span>, <span class="string">$&quot;Welcome <span class="subst">&#123;user1.UserName&#125;</span> to our world&quot;</span>,</span><br><span class="line">            DateTime.Now.ToShortTimeString()); <span class="comment">//Use Hub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Ok&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
       <hr><span style="font-style: italic;color: gray;"> Please indicate the source of the reprint. Please verify the source of the quotation in the article. Please point out any mistakes or unclear expressions. You can comment in the comments section below or email johnson27945@outlook.com, thank you for your support! </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ¬©2016-2020 zlog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="ÂàáÊç¢ÂÖ®Â±è Âø´Êç∑ÈîÆ s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*Ê∏≤ÊüìÂØπÂ∫îÁöÑË°®Ê†ºÊ†∑Âºè*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*Ê∏≤ÊüìÊâìËµèÊ†∑Âºè*/
        

        /*È´ò‰∫Æ‰ª£Á†ÅÂùóË°åÂè∑*/
        

        /*ËÆøÈóÆÊï∞Èáè*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*‰ª£Á†ÅÈ´ò‰∫ÆÔºåË°åÂè∑ÂØπÈΩê*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
        /* Ê∏≤Êüì*/
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }
        if (window.mermaid){
            window.mermaid = null
        }
        $.getScript("//cdn.jsdelivr.net/npm/mermaid@8.4.2/dist/mermaid.min.js", function () {
            var mermaidOptions = JSON.parse(HTMLDecode("{&#34;theme&#34;:&#34;default&#34;,&#34;startOnLoad&#34;:true,&#34;flowchart&#34;:{&#34;useMaxWidth&#34;:false,&#34;htmlLabels&#34;:true}}"))
            if (window.mermaid) {
                mermaid.initialize(mermaidOptions)
                mermaid.contentLoaded()
            }
        })
        
    }

    /*ÊâìËµèÈ°µÈù¢ÈöêËóè‰∏éÂ±ïÁ§∫*/
    

</script>

<!--Âä†ÂÖ•Ë°åÂè∑ÁöÑÈ´ò‰∫Æ‰ª£Á†ÅÂùóÊ†∑Âºè-->

<!--Ëá™ÂÆö‰πâÊ†∑ÂºèËÆæÁΩÆ-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*ÂàóË°®Ê†∑Âºè*/
    

    /* ËÉåÊôØÂõæÊ†∑Âºè */
    
    


    /*ÂºïÁî®ÂùóÊ†∑Âºè*/
    

    /*ÊñáÁ´†ÂàóË°®ËÉåÊôØÂõæ*/
    

    
</style>






<div class="mobile-menus-out" >

</div>
<div class="mobile-menus">
    
    
    
    
    <a class="dynamic-menu " target="_blank"  href="https://github.com/tjtgzxs">github</a>
    
</div>


</html>
